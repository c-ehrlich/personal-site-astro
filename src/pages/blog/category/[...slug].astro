---
import { getCollection, type CollectionEntry } from "astro:content";
import ContentLayout from "../../../layouts/ContentLayout.astro";
import { typedKeys } from "../../../util/object";

export async function getStaticPaths() {
  const docs = await getCollection("content");

  const typeToHeader = {
    talk: "Talks",
    appearance: "Appearances",
    article: "Articles",
    video: "Videos",
  } as const;

  return typedKeys(typeToHeader).map((type) => ({
    params: { slug: type },
    props: {
      header: typeToHeader[type],
      posts: docs.filter((doc) => doc.data.type === type),
    },
  }));
}

interface Props {
  header: string;
  posts: CollectionEntry<"content">[];
}

const { header, posts }: Props = Astro.props;
---

<ContentLayout header={header} posts={posts} />
